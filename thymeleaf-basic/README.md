# [스프링 MVC 2편 - 백엔드 웹 개발 활용 기술](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-mvc-2/dashboard)

## 섹션 9. 타임리프 - 기본 기능

### 4. 프로젝트 생성

### 5. 타임리프 소개

- 굳이 타임리프를 배워야 하나 싶긴 하지만, 강의를 따라가보려고 한다.

- 특징
  - 서버 사이드 HTML 렌더링 (SSR)
  - 네츄럴 템플릿:순수 HTML을 그대로 유지하면서 뷰 템플릿도 사용할 수 있는 타임리프의 특징
  - 스프링 통합 지원

### 6. 텍스트 - text, utext

```html
<li>th:text 사용 <span th:text="${data}"></span></li>
<li>컨텐츠 안에서 직접 출력하기 = [[${data}]]</li>
```

#### Escape

- HTML 문서는 < , > 같은 특수 문자를 기반으로 정의된다.
- 따라서 뷰 템플릿으로 HTML 화면을 생성할 때는 출력하는 데이터에 이러한 특수 문자가 있는 것을 주의해서 사용해야 한다.
- 웹 브라우저는 < 를 HTML 테그의 시작으로 인식한다. 따라서 < 를 테그의 시작이 아니라 문자로 표현할 수 있는 방법이 필요한데, 이것을 HTML 엔티티라 한다.
- 그리고 **HTML에서 사용하는 특수 문자를 HTML 엔티티로 변경하는 것을 이스케이프(escape)**라 한다.
- 그리고 **타임리프가 제공하는 th:text , [[...]] 는 기본적으로 이스케이프(escape)를 제공한다.**

#### Unescape

- `th:text` -> `th:utext`
- `[[...]]` -> `[(...)]`

- 실제 서비스를 개발하다 보면 escape를 사용하지 않아서 HTML이 정상 렌더링 되지 않는 수 많은 문제가 발생한다.
- **escape를 기본으로 하고, 꼭 필요한 때만 unescape를 사용하자.**

### 7. 변수 - SpringEL

- 보다보니 html에서 사용하는 타임리프의 변수사용은 리터럴템플릿 문법같다.
- `th:with` 를 사용하면 지역 변수를 선언해서 사용할 수 있다.

### 8. 기본 객체들

- 타임리프는 기본 객체들을 제공한다.
  - ${#request} - 스프링 부트 3.0부터 제공하지 않는다.
  - ${#response} - 스프링 부트 3.0부터 제공하지 않는다.
  - ${#session} - 스프링 부트 3.0부터 제공하지 않는다.
  - ${#servletContext} - 스프링 부트 3.0부터 제공하지 않는다.
  - ${#locale}
- 스프링 부트 3.0 부터는 ${#request} , ${#response} , ${#session} , ${#servletContext} 를 지원하지 않는다.
- **직접 model 에 해당 객체를 추가해서 사용해야 한다.**
  - 더 명시적으로 변경된 것
- HTTP 요청 파라미터 접근: param
- 스프링 빈 접근: @ 예) ${@helloBean.hello('Spring!')}
  - 명시적으로 이름을 지정 필요

### 9. 유틸리티 객체와 날짜

### 10. URL 링크

- 단순한 URL: @{/hello} /hello

- 쿼리 파라미터

  - @{/hello(param1=${param1}, param2=${param2})}
  - /hello?param1=data1&param2=data2
  - () 에 있는 부분은 쿼리 파라미터로 처리된다.

- 경로 변수

  - @{/hello/{param1}/{param2}(param1=${param1}, param2=$param2})}
  - /hello/data1/data2
  - URL 경로상에 변수가 있으면 () 부분은 경로 변수로 처리된다.

- 경로 변수 + 쿼리 파라미터

  - @{/hello/{param1}(param1=${param1}, param2=${param2})}/hello/data1?param2=data2
  - 경로 변수와 쿼리 파라미터를 함께 사용할 수 있다.

- 상대경로, 절대경로, 프로토콜 기준을 표현할 수 도 있다.
  - /hello : 절대 경로
  - hello : 상대 경로

### 11. 리터럴

- 타임리프에서 문자 리터럴은 항상 ' (작은 따옴표)로 감싸야 한다.
  - <span th:text="'hello'">
- 공백 없이 쭉 이어진다면 하나의 의미있는 토큰으로 인지해서 다음과 같이 작은 따옴표를 생략할 수 있다.

- <span th:text="hello world!"></span>
  - 문자 리터럴은 원칙상 ' 로 감싸야 한다. 중간에 공백이 있어서 하나의 의미있는 토큰으로도 인식되지 않는다.
  - 수정 - <span th:text="'hello world!'"></span>
- 리터럴 대체(Literal substitutions)
  - <span th:text="|hello ${data}|">

### 12. 연산

- 비교연산: HTML 엔티티를 사용해야 하는 부분을 주의하자
  - (gt), < (lt), >= (ge), <= (le), ! (not), == (eq), != (neq, ne)
- 조건식: 자바의 조건식과 유사하다.
- Elvis 연산자: 조건식의 편의 버전
- No-Operation: \_ 인 경우 마치 타임리프가 실행되지 않는 것 처럼 동작한다. HTML의 내용 그대로 활용할 수 있다.

### 13. 속성 값 설정

- 타임리프는 주로 HTML 태그에 `th:*` 속성을 지정하는 방식으로 동작한다.
- `th:*` 로 속성을 적용하면 기존 속성을 대체한다. 기존 속성이 없으면 새로 만든다.

- th:attrappend : 속성 값의 뒤에 값을 추가한다.
- th:attrprepend : 속성 값의 앞에 값을 추가한다.
- th:classappend : class 속성에 자연스럽게 추가한다.

### 14. 반복

- `<tr th:each="user, userStat : ${users}">`
- 두번째인자는 반복 상태 유지 기능
  - index : 0부터 시작하는 값
  - count : 1부터 시작하는 값
  - size : 전체 사이즈
  - even , odd : 홀수, 짝수 여부( boolean )
  - first , last :처음, 마지막 여부( boolean )
  - current : 현재 객체

### 15. 조건부 평가

- 타임리프는 해당 조건이 맞지 않으면 태그 자체를 렌더링하지 않는다.
- 만약 다음 조건이 false 인 경우 <span>...<span> 부분 자체가 렌더링 되지 않고 사라진다.
  - <span th:text="'미성년자'" th:if="${user.age lt 20}"></span>

### 16. 주석

1. 표준 HTML 주석
   자바스크립트의 표준 HTML 주석은 타임리프가 렌더링 하지 않고,
   그대로 남겨둔다.

2. 타임리프 파서 주석
   타임리프 파서 주석은 타임리프의 진짜 주석이다.
   렌더링에서 주석 부분을 제거한다.

3. 타임리프 프로토타입 주석
   타임리프 렌더링을 거치면 이 부분이 정상 렌더링 된다.
   쉽게 이야기해서 HTML 파일을 그대로 열어보면 주석처리가 되지만, 타임리프를 렌더링 한 경우에만 보이는 기능이다.

### 17. 블록

- <th:block> 은 HTML 태그가 아닌 타임리프의 유일한 자체 태그다.
- 프레그먼트랑 유사해보인다.

### 18. 자바스크립트 인라인

### 19. 템플릿 조각

- 컴포넌트화

### 20. 템플릿 레이아웃1

### 21. 템플릿 레이아웃2

### 22. 정리
